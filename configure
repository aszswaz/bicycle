#!/bin/zsh -e

cd "$(dirname $0)"

function build() {
    git submodule init

    makepkg -f -s -i

    ./bicycle-config/init.sh
    ./neovim/init.sh
    ./shell/init.sh
    ./tools-config/init.sh
}

function clean() {
    local file
    for file in *.pkg.tar.zst; do
        rm -v "$file"
    done

    files=('pkg' 'src' 'cpp/build' 'python/venv')
    for file in ${file[*]}; do
        if [[ -e $file ]]; then
            rm -rfv "$file"
        fi
    done
}

if [[ $1 == clean ]]; then
    clean
else
    build
fi
